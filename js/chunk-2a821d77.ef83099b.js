(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a821d77"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"3f14":function(t,e,a){"use strict";a.r(e);var s=a("ce7e"),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-5"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-3 col-lg-4 col-md-5 col-sm-6 col-xs-6 mb-1"},[e("label",[t._v(t._s(t.periode)+" : ")]),e("div",{staticClass:"data-picker",staticStyle:{width:"100%"}},[e("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"-",format:"dd/MM/yyyy",clearable:t.clearable,"picker-options":t.pickerOptions},on:{change:function(e){return t.loadFilter()}},model:{value:t.drp,callback:function(e){t.drp=e},expression:"drp"}})],1)]),e("div",{staticClass:"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 margin-bottom"},[e("label",[t._v("Choisir le status : ")]),e("div",{staticClass:"data-picker",staticStyle:{width:"100%"}},[e("ui-select",{attrs:{placeholder:"Choisir une usine",options:t.status},on:{change:function(e){return t.loadConfig()}},model:{value:t.statusSelect,callback:function(e){t.statusSelect=e},expression:"statusSelect"}})],1)]),e("div",{staticClass:"col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3 margin-bottom ml-2"},[e("label",[t._v("Auteur : ")]),e("div",{staticClass:"data-picker",staticStyle:{width:"100%"}},[e("ui-select",{attrs:{placeholder:"Choisir une usine",options:t.usersList},on:{change:function(e){return t.loadConfig()}},model:{value:t.usersSelect,callback:function(e){t.usersSelect=e},expression:"usersSelect"}})],1)])]),e(s["a"],{staticClass:"mt-5"}),t.all_commande.length>0&&0==t.loading?e("div",{staticClass:"card mt-3"},[e("TableList",{attrs:{all_commande:t.all_commande,loadConfig:t.loadFilter,type:t.type}})],1):t._e(),e("div",{staticClass:"mt-3"},[[e("el-skeleton",{attrs:{loading:t.loading,animated:"",rows:6}})]],2),0!=t.all_commande.length&&""!=t.all_commande.length&&" "!=t.all_commande.length||0!=t.loading?t._e():e("div",{staticClass:"resultat"},[e("el-empty",{attrs:{description:"Pas de donnÃ©es"}})],1)],1)},l=[],o=a("c7eb"),r=a("1da1"),c=(a("d3b7"),a("159b"),a("caad"),a("b0c0"),a("14d9"),a("3c65"),a("2532"),a("cee4")),i=a("c1df"),u=a.n(i),d=a("323e"),m=a.n(d),p=(a("4de4"),a("ac1f"),a("841c"),function(){var t=this,e=t._self._c;return e("el-table",{staticStyle:{width:"100% cursor:pointer"},attrs:{data:t.all_commande.filter((function(e){return!t.search||e.code.toLowerCase().includes(t.search.toLowerCase())}))}},[e("el-table-column",{attrs:{label:"status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[0==a.row.status?e("el-tag",{attrs:{type:"info",size:"medium"}},[t._v(t._s(a.row.status_t))]):t._e(),1==a.row.status?e("el-tag",{attrs:{size:"medium"}},[t._v(t._s(a.row.status_t))]):t._e(),2==a.row.status?e("el-tag",{attrs:{type:"success",size:"medium"}},[t._v(t._s(a.row.status_t))]):t._e()]}}])}),e("el-table-column",{attrs:{label:"Code",prop:"code"}}),e("el-table-column",{attrs:{label:"Client",prop:"nom_client"}}),e("el-table-column",{attrs:{label:"Prix total",prop:"prix_total"}}),e("el-table-column",{attrs:{label:"Auteur",prop:"name"}}),e("el-table-column",{attrs:{label:"Date de creation",prop:"created_at"}}),e("el-table-column",{attrs:{align:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"row mr-2"},[e("el-select",{staticClass:"col",attrs:{change:t.handleChangeState(a.row),placeholder:"Status",size:"small"},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}},t._l(t.optionStatus,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})})),1)],1)]}}])},[e("template",{slot:"header"},[e("el-input",{attrs:{size:"mini",placeholder:"Type to search"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],2)],1)}),f=[],h={props:["all_commande","loadConfig"],data:function(){return{search:"",optionStatus:[{label:"En cours",value:0},{label:"En attente de recuperation",value:1},{label:"Terminer",value:2}]}},methods:{handleChangeState:function(t){var e=this;m.a.start(),this.all_commande.forEach((function(a){a.id==t.id&&(a.status_active===t.status?console.log("equal"):(console.log("update"),e.updateCommande(t)))})),m.a.done()},showRow:function(t){console.log(t)},updateCommande:function(t){var e=this;return Object(r["a"])(Object(o["a"])().mark((function a(){var s;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s={id:t.id,status:t.status},m.a.start(),a.prev=2,a.next=5,c["a"].post("xpress/commande/updateState",s);case 5:e.$notify({type:"success",title:"Enregistrer"}),e.loadConfig(),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](2),e.$notify({type:"error",title:"Echec d'enregistrement"});case 12:m.a.done();case 13:case"end":return a.stop()}}),a,null,[[2,9]])})))()}}},b=h,v=a("2877"),w=Object(v["a"])(b,p,f,!1,null,null,null),_=w.exports,g={components:{TableList:_},data:function(){return{type:"periode",is_done:0,status:[],usersList:[],usersSelect:"",statusSelect:"",periode:"Choisir la periode",start:u()().subtract(12,"month").startOf("month").toDate(),end:u()().toDate(),clearable:!0,drp:[u()().subtract(1,"isoweek").startOf("isoweek").toDate(),u()().toDate()],pickerOptions:{shortcuts:[{text:"Mois precedent",onClick:function(t){t.$emit("pick",[u()().subtract(1,"month").startOf("month").toDate(),u()().subtract(1,"month").endOf("month").toDate()])}},{text:"Mois en cours",onClick:function(t){t.$emit("pick",[u()().startOf("month").toDate(),new Date])}},{text:"Semaine precedente",onClick:function(t){t.$emit("pick",[u()().subtract(1,"week").startOf("isoWeek").toDate(),u()().subtract(1,"week").endOf("isoWeek").toDate()])}},{text:"Semaine en cours",onClick:function(t){t.$emit("pick",[u()().startOf("isoWeek").toDate(),new Date])}},{text:"Avant hier",onClick:function(t){t.$emit("pick",[u()().subtract(2,"day").toDate(),u()().subtract(2,"day").toDate()])}},{text:"Hier",onClick:function(t){t.$emit("pick",[u()().subtract(1,"day").toDate(),u()().subtract(1,"day").toDate()])}},{text:"Aujoudhuit",onClick:function(t){t.$emit("pick",[u()().toDate(),new Date])}}],format:"dd MM yyyy",firstDayOfWeek:1,disabledDate:this.disabledDueDate},loading:!1,all_commande:[]}},created:function(){u.a.locale("fr"),this.loadFilter()},methods:{disabledDueDate:function(t){return!(t>=this.start&&t<=this.end)},loadFilter:function(){var t=this;return Object(r["a"])(Object(o["a"])().mark((function e(){var a,s,n,l,r,i,d,p;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return m.a.start(),e.prev=1,a={start:u()(new Date(t.drp[0])).startOf("day").format("YYYY-MM-DD HH:mm:ss.SSS"),end:u()(new Date(t.drp[1])).endOf("day").format("YYYY-MM-DD HH:mm:ss.SSS")},e.next=5,c["a"].post("xpress/commande/getFilter",a);case 5:s=e.sent,n=s.data.users,l=[],r=[],i=[],d=[],p="",n.forEach((function(t){d.includes(t.name)||(d.push(t.name),i.push({label:t.name,value:t.id})),0==t.status?(p="En cours",l.includes(p)||(l.push(p),r.push({label:p,value:t.status}))):1==t.status?(p="En attente de Recuperation",l.includes(p)||(l.push(p),r.push({label:p,value:t.status}))):2==t.status&&(p="Terminer",l.includes(p)||(l.push(p),r.push({label:p,value:t.status})))})),t.usersList=i,t.usersList.unshift({label:"Tous",value:0}),t.usersSelect=t.usersList[0],t.status=r,t.status.unshift({label:"Tous",value:4}),t.statusSelect=t.status[0],t.loadConfig(),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](1),t.$notify({type:"error",title:"Echec de recuperation"});case 25:m.a.done();case 26:case"end":return e.stop()}}),e,null,[[1,22]])})))()},loadConfig:function(){var t=this;return Object(r["a"])(Object(o["a"])().mark((function e(){var a,s,n;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,m.a.start(),a={start:u()(new Date(t.drp[0])).startOf("day").format("YYYY-MM-DD HH:mm:ss.SSS"),end:u()(new Date(t.drp[1])).endOf("day").format("YYYY-MM-DD HH:mm:ss.SSS"),status:t.statusSelect["value"],user:t.usersSelect["value"]},console.log(a),e.next=6,c["a"].post("/xpress/commande/allPressingCmdUser",a);case 6:s=e.sent,t.loading=!1,n=s.data.commande,n.forEach((function(t){0==t.status?t["status_t"]="en cours":1==t.status?t["status_t"]="En attente de R":2==t.status&&(t["status_t"]="Terminer"),t["status_active"]=t.status,t.created_at=u()(new Date(t.created_at)).startOf("day").format("DD/MM/YYYY HH:mm:ss"),console.log(t.created_at)})),t.all_commande=n,t.all_commande_detail=s.data.commande_details,m.a.done();case 13:case"end":return e.stop()}}),e)})))()},handleChangeState:function(t){var e=this;m.a.start(),this.all_commande.forEach((function(a){a.id==t.id&&!a.status_active===t.status&&(console.log("update"),e.updateCommande(t))})),m.a.done()},updateCommande:function(t){var e=this;return Object(r["a"])(Object(o["a"])().mark((function a(){return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return m.a.start(),a.prev=1,a.next=4,c["a"].post("xpress/commande/update",t);case 4:e.$notify({type:"success",title:"Enregistrer"}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](1),e.$notify({type:"error",title:"Echec d'enregistrement"});case 10:m.a.done();case 11:case"end":return a.stop()}}),a,null,[[1,7]])})))()}}},k=g,x=(a("c56b"),Object(v["a"])(k,n,l,!1,null,null,null));e["default"]=x.exports},"841c":function(t,e,a){"use strict";var s=a("c65b"),n=a("d784"),l=a("825a"),o=a("7234"),r=a("1d80"),c=a("129f"),i=a("577e"),u=a("dc4a"),d=a("14c3");n("search",(function(t,e,a){return[function(e){var a=r(this),n=o(e)?void 0:u(e,t);return n?s(n,e,a):new RegExp(e)[t](i(a))},function(t){var s=l(this),n=i(t),o=a(e,s,n);if(o.done)return o.value;var r=s.lastIndex;c(r,0)||(s.lastIndex=0);var u=d(s,n);return c(s.lastIndex,r)||(s.lastIndex=r),null===u?-1:u.index}]}))},c56b:function(t,e,a){"use strict";a("cf47")},cf47:function(t,e,a){}}]);
//# sourceMappingURL=chunk-2a821d77.ef83099b.js.map